<!DOCTYPE html>
<html>
<head>
    <title>Date Parsing Test</title>
</head>
<body>
    <h1>Date Parsing Test</h1>
    <div id="results"></div>
    
    <script>
        function getCalendarWeek(dateString) {
            if (!dateString || !dateString.includes(' - ')) {
                return `ERROR: Invalid format - ${dateString}`;
            }
            
            const [dayPart, datePart] = dateString.split(' - ');
            
            // Parse the date for 2025
            const year = 2025;
            let month, day;
            
            // Extract month and day from date part (e.g. "September 3")
            const monthNames = {
                'September': 8, 'October': 9, 'November': 10, 'December': 11
            };
            
            const dateWords = datePart.split(' ');
            if (dateWords.length >= 2) {
                month = monthNames[dateWords[0]];
                day = parseInt(dateWords[1]);
                
                if (month !== undefined && !isNaN(day)) {
                    const date = new Date(year, month, day);
                    
                    // Semester starts September 3, 2025 (Wednesday)
                    // Week 1 starts on the Sunday before: August 31, 2025
                    const firstSunday = new Date(2025, 7, 31); // August 31, 2025 (Sunday)
                    
                    // Find the Sunday of the current date's week
                    const dayOfWeek = date.getDay(); // 0 = Sunday, 1 = Monday, etc.
                    const startOfWeek = new Date(date);
                    startOfWeek.setDate(date.getDate() - dayOfWeek);
                    
                    // Calculate week number based on first Sunday of semester
                    const weeksDiff = Math.floor((startOfWeek - firstSunday) / (7 * 24 * 60 * 60 * 1000));
                    const calculatedWeek = Math.max(1, weeksDiff + 1);
                    
                    return `Week ${calculatedWeek} (parsed: ${date.toDateString()}, startOfWeek: ${startOfWeek.toDateString()}, dayOfWeek: ${dayOfWeek}, weeksDiff: ${weeksDiff})`;
                }
            }
            
            return `ERROR: Could not parse - dayPart="${dayPart}", datePart="${datePart}", dateWords=[${dateWords?.join(', ')}], month=${month}, day=${day}`;
        }
        
        // Test our problematic dates
        const testDates = [
            "F - September 19",
            "T - September 23",
            "W - September 3",  // First day of semester
            "M - September 1"   // Before semester starts
        ];
        
        const resultsDiv = document.getElementById('results');
        
        testDates.forEach(dateString => {
            const result = getCalendarWeek(dateString);
            const div = document.createElement('div');
            div.innerHTML = `<strong>${dateString}</strong>: ${result}`;
            div.style.margin = '10px 0';
            div.style.padding = '10px';
            div.style.border = '1px solid #ccc';
            div.style.backgroundColor = result.includes('ERROR') ? '#ffeeee' : '#eeffee';
            resultsDiv.appendChild(div);
        });
    </script>
</body>
</html>
